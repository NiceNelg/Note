# GCC调试

### 编译

在gcc调试中，若要对代码进行调试可在编译代码是带上-g选项，如：

`gcc -g 源码文件名 -o 程序名`

> 在代码调试过程中需要用到源码，因为-g选项并不是将调试代码嵌入到源码中只是会与源代码进行关联，因此需要用到源代码。

### 调试

##### 代码调试步骤：

   	1. 运行：gdb 程序名
   	2. 开始调试：进入调试界面后使用命令start开始代码调试
   	3. 下一步：敲入命令next或n程序运行到下一步，重复按回车可以默认输入上一行命令

> 若程序需要带参数（即主函数`int main(int argc, char *argv[])`形式的，可在运行第一步后使用`set args 参数1 参数2 ...`设置程序运行的参数，之后再执行第二步之后的操作。）

##### 拓展：

- 使用step能跳进函数中单步执行

- 使用p 变量的方式查看变量

- 查看内存方式

- 若需要查看变量或函数内存可输入：p &变量名

- 上述命令会显示变量内容和变量对应的内存地址

- 查看指定内存地址的栈内容：

  `x/<n/f/u> <addr>`

  > n、f、u是可选的参数，<addr>表示一个内存地址

  1. n 是一个正整数，表示显示内存的长度，也就是说从当前地址向后显示几个地址的内容

  2. f 表示显示的格式

  3. u 表示将多少个字节作为一个值取出来，如果不指定的话，GDB默认是4个bytes，如果不指定的话，默认是4个bytes。当我们指定了字节长度后，GDB会从指内存定的内存地址开始，读写指定字节，并把其当作一个值取出来。

  4. 参数 f 的可选值：

     - x 按十六进制格式显示变量。
     - d 按十进制格式显示变量。
     - u 按十六进制格式显示无符号整型。
     - o 按八进制格式显示变量。
     - t 按二进制格式显示变量。
     - a 按十六进制格式显示变量。
     - c 按字符格式显示变量。
     - f 按浮点数格式显示变量。

  5. 参数 u 可以用下面的字符来代替：

     - b 表示单字节

     - h 表示双字节

     - w 表示四字 节

     - g 表示八字节

       如：

       ```c
       (gdb) p record

       $10 = {12, 76, 48, 62, 94, 17, 32, 37, 52, 69}

       (gdb) p &record

       $11 = (int (*)[10]) 0x8049740

       (gdb) x/4uw 0x8049740

       0x8049740 <record>:    12    76    48    62

       (gdb) x/6ow 0x8049740

       0x8049740 <record>:    014    0114    060    076

       0x8049750 <record+16>:    0136    021
       ```

       ​